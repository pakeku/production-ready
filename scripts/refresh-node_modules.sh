#!/bin/bash

echo "ğŸš€ Buckle up! We're going on a node_modules safari through your monorepo..."

# Remove node_modules from apps
echo "ğŸ§¹ Scanning /apps for node_modules... (hold onto your RAM!)"
if find ./apps -type d -name "node_modules" -exec rm -rf {} + 2>/dev/null; then
    echo "âœ… /apps cleared. Node_modules have been evicted like bad cookies ğŸª"
else
    echo "âš ï¸ No node_modules found in /apps. Either your apps are minimalistic or already enlightened."
fi

# Remove node_modules from packages
echo "ğŸ” Searching /packages for node_modules... brace yourself, disk space is coming!"
if find ./packages -type d -name "node_modules" -exec rm -rf {} + 2>/dev/null; then
    echo "âœ… /packages cleared. Dependency debris successfully vacuumed ğŸ§½"
else
    echo "âš ï¸ /packages is already as clean as my conscience after unit tests pass ğŸ˜‡"
fi

# Remove root node_modules
echo "ğŸ  Checking the root for node_modules... it's always hiding here somewhere, isn't it?"
if rm -rf ./node_modules 2>/dev/null; then
    echo "âœ… Root cleaned! You can almost hear your hard drive sigh in relief ğŸ’¾"
else
    echo "âš ï¸ Nothing to remove in root. Your project is practically zen ğŸ§˜â€â™‚ï¸"
fi

echo "Installing fresh dependencies... because who doesn't love a good makeover? ğŸ’…"
pnpm install

echo "ğŸ‰ All done! Node_modules refreshed. â˜•"
echo "ğŸ’¡ Pro tip: 'rm -rf node_modules' is like Ctrl+Alt+Del for your dependencies â€” handle with care!"